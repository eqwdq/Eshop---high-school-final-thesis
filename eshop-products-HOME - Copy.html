<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>

    <!-- fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Lobster&family=Rubik:ital,wght@1,300&display=swap" rel="stylesheet">

	<!-- bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href="test1.css">
    <link rel="icon" type="image/x-icon" href="C:\xampp\htdocs\KOP\images\swagtocat.png">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <ul class="nav me-auto my-2 my-lg-0">
                <a class="navbar-brand">Vaše Oblečenie</a>
                <li class="nav-item">
                    <a class="nav-link active" href="eshop-products-HOME.html">Domov</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="eshop-products.html">Produkty</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " href="#">kontakt</a>
                </li>

                <li class="nav-item justify-content-end">
                    <!-- sign in -->
                    <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSignIn" aria-controls="offcanvasSignIn">Prihlásiť sa</button>

                    <div class="offcanvas offcanvas-top" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasSignIn" aria-labelledby="offcanvasSignInLabel">
                        <div class="offcanvas-header">
                            <h5 class="offcanvas-title" id="offcanvaSignInLabel">Prihlásenie/Registrácia</h5>
                            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                        </div>

                        <div class="offcanvas-body">
                            <div class="text-center" id="main-div">
                                <main class="form-signin">
                                    <form>
                                        <div class="form-floating">
                                            <input type="email" class="form-control" id="floatingInput" placeholder="name@example.com">
                                            <label for="floatingInput">Email address</label>
                                        </div>
                                        <div class="form-floating">
                                            <input type="password" class="form-control" id="floatingPassword" placeholder="Password">
                                            <label for="floatingPassword">Password</label>
                                        </div>
                                        <br>
                                        <button class="btn btn-lg btn-primary btn-lg" type="submit">Prihlasiť sa</button>
                                        <button class="btn btn-lg btn-primary btn-lg" type="submit">Registrovať sa</button>
                                    </form>
                                </main>
                            </div>
                        </div>
                    <!--end of sign in -->
                    </div>
                </li>
            </ul>
        </div>
    </nav>

    <!-- start of carousel -->
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="C:\xampp\htdocs\KOP\images\stock-photo-young-curly-mature-man-wearing-an-elegant-shirt-being-shocked-because-of-something-she-has-seen-1639970746.jpg" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="C:\xampp\htdocs\KOP\images\stock-photo-beautiful-blonde-woman-wear-of-white-set-of-track-suit-isolated-on-pastel-background-1926854804.jpg" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="C:\xampp\htdocs\KOP\images\stock-photo-full-length-body-size-girl-wearing-white-hoodie-jumping-up-with-backpack-isolated-pastel-pink-color-2015271203.jpg" class="d-block w-100" alt="...">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
    <!-- end of carousel -->

    <section class="shop">
        <div id="productsDiv" class="row">

             <div class="row py-5">
                <div class="col-lg-8 m-auto text-center">
                    <h1>Produkty</h1>
                </div>
            </div>

        </div>
    </section>

    <!-- expanding shopping cart with offcanvas -->
    <div class="text-center">
        <button class="btn btn-primary defaultButton col-1 position-relative" type="button" data-bs-toggle="offcanvas"
        data-bs-target="#offcanvasCart" aria-controls="offcanvasScrolling">
        Košík
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="badge">20</span>
        </button>
    </div>

    <div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasCart" aria-labelledby="offcanvasCartLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasCartLabel">Nákupný Košík</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="cart-items">

                <!-- ukazka kody ktora by tu mala byt -->
                <!-- <div class="col cart-row">
                    <div class="card shadow-sm bg-light mb-2">
                        <img src="http://localhost:8080/KOP/images/luca-zanon-26595-unsplash.jpg" class="img-fluid" alt="">
                        <div class="card-body text-center">
                            <h6 class="cart-item-title">Produkt 8</h6>
                        </div>
                        <div class="card-footer">
                            <p class="float-start cart-price">69.99€</p>
                            <button class="btn btn-outline-danger btn-sm float-end">Vymazať</button>
                            <input type="number" value="6" class="float-end cart-quantity-input">
                        </div>
                    </div>
                </div> -->

            </div>
        </div>
        <div class="offcanvas-footer">
            <div class="cart-total">
                <strong class="cart-total-title">Total</strong>
                <span class="cart-total-price">0€</span>
                <button class="btn btn-outline-primary btn-md float-end btn-purchase">Kúpiť</button>
            </div>
        </div>
    </div>
<!--end of offcanvas-->

<!-- -------------------------------------- off canvas sign in --------------------------------------------------------------------------
<button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSignIn" aria-controls="offcanvasSignIn">Prihlásiť sa</button>

<div class="offcanvas offcanvas-top" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasSignIn" aria-labelledby="offcanvasSignInLabel">
<div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvaSignInLabel">Prihlásenie/Registrácia</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
</div>
<div class="offcanvas-body">
    ---------------------------- sign in  ------------------------
    <div class="text-center" id="main-div">
        <main class="form-signin">
            <form>
            <div class="form-floating">
                <input type="email" class="form-control" id="floatingInput" placeholder="name@example.com">
                <label for="floatingInput">Email address</label>
            </div>
            <div class="form-floating">
                <input type="password" class="form-control" id="floatingPassword" placeholder="Password">
                <label for="floatingPassword">Password</label>
            </div>
            <br>
            <button class="btn btn-lg btn-primary btn-lg" type="submit">Prihlasiť sa</button>
            <button class="btn btn-lg btn-primary btn-lg" type="submit">Registrovať sa</button>
            </form>
        </main>
    </div>
    -------------------------- end of sign in ---------------------
</div>
</div> -->
<!----------------------------- end of off canvas sign in ------------------->
    <footer>
        <div class="container">
            <div class="row">

                <div class="contact-footer col-md-4">
                    <h2>Kontakt</h2>
                    <ul class="menu-item">
                        <li >
                            <a href="#"> O nás</a>
                        </li>
                        <li>
                            <a href="tel:0902 100 564"> 0902 100 564 </a>
                        </li>
                        <li>
                            <a href="https://www.google.sk/maps/place/Hodin%C3%A1rstvo+Emili/@48.4263709,17.7977718,17z/data=!3m1!4b1!4m5!3m4!1s0x476b5a5597f2200b:0x961be76d1902eb2e!8m2!3d48.4263674!4d17.7999605" target="_blank"> Firma s.r.o
                        </a>
                        </li>
                        <li>
                            <a href="mailto::danielf0804@gmail.com"> email: danielf0804@gmail.com
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="contact-formular col-md-4">
                    <div class="mb-3">
                        <h2>Pošlite nám správu</h2>
                        <input type="email" class="form-control" id="exampleFormControlInput1" placeholder="email@example.com">
                    </div>
                    <div class="mb-3">
                        <label for="exampleFormControlTextarea1" class="form-label">Text Správy</label>
                        <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
                    </div>
                    <button type="button" class="btn1">Odoslať</button>


                </div>
            </div>
        </div>
    </footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>



<script type="module">

    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.3/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.3/firebase-analytics.js";
    import { getStorage, ref as sRef, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.6.3/firebase-storage.js";
    import { getDatabase, ref, get, set, child, update, remove } from "https://www.gstatic.com/firebasejs/9.6.3/firebase-database.js";
    import { getFirestore, doc, getDoc, setDoc, collection, addDoc, updateDoc  } from "https://www.gstatic.com/firebasejs/9.6.3/firebase-firestore.js";

    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
        apiKey: "AIzaSyCI5SdwdXMQeu3y7AQPZnkcZH_GmIcSgKw",
        authDomain: "login-9a8b6.firebaseapp.com",
        databaseURL: "https://login-9a8b6-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "login-9a8b6",
        storageBucket: "login-9a8b6.appspot.com",
        messagingSenderId: "663312681266",
        appId: "1:663312681266:web:aaff10c5e0a58994ceaf2b",
        measurementId: "G-XTC30ZEDBX"
    };


    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const realdb = getDatabase();
    const db = getFirestore();

    var outerDiv = document.getElementById('productsDiv');
    var arrayOfProducts = [];
    window.addEventListener('load',GetAllProducts);

    function GetAllProducts() {
        const dbref= ref(realdb);

        get(child(dbref, "ProductRealdb"))
        .then((snapshot) =>  {
            snapshot.forEach(prod => {
                arrayOfProducts.push(prod.val());
            });
            addAllProducts();
        })
    }

    function addAllProducts() {
        let i = 0;
        arrayOfProducts.forEach(prod => {
            addProduct(prod, i++)
        });
        assingAllEvent()
    }

    function addProduct(product, index) {
        let html =

        `
        <div class="card shadow-sm bg-light mb-2">
            <img src="`+ product.linksOfImagesArray +`" class="img-fluid shop-item-image thumb" id="thumb-`+ index +` alt="">
            <div class="card-body text-center">
                <h6 class="shop-item-title title detbtn" id="title-`+ index +`">`+ getShortTitle(product.ProductTitle) +`</h6>
                <p class="card-text" id="card-text">`+ getUl(product.Points) +`</p>
            </div>
            <div>
                <small class="text-muted float-start">`+ GenerateStockLabel(product.Stock) +`</small>
            </div>
            <div class="card-footer shop-item-details">
                <p class="float-start top shop-item-price" id="shop-item-price">`+ product.Price +` €</p>
                <button class="btn btn-outline-dark float-end shop-item-button ">Do košíka</button>
            </div>
        </div>
        `

        let newProd = document.createElement('div');
        newProd.classList.add('col-12', 'col-sm-6', 'col-xl-2', 'col-md-4', 'col-lg-3');
        newProd.innerHTML = html;
        outerDiv.append(newProd);
    }

    function GenerateStockLabel(stock) {
        let stocklabel = document.createElement('h6');
        stocklabel.classList.add('stock');

        if(stock > 0) {
            stocklabel.innerHTML = 'na sklade';
        }
        else {
            stocklabel.innerHTML = 'nie je na sklade';
            stocklabel.classList.add('text-warning');
        }
        return stocklabel.outerHTML;
    }

    function getUl(array) {
        let ul = document.createElement('ul');
        ul.classList.add('points');

        array.forEach(element => {
            let li = document.createElement('li')
            li.innerText = element;
            ul.append(li);
        });
        return ul.outerHTML;
    }

    function getShortTitle(title){
        if(title.lenght > 49) title = title.substring(0,47);
        else return title;
        return title + "..."
    }

    function getProductIndex(id) {
        var indstart = id.indexOf('-') + 1;
        var indend= id.lenght;
        return Number(id.substring(indstart,indend));
    }

    function goToProductDetails(event) {
        var index = getProductIndex(event.target.id);
        localStorage.product = JSON.stringify(arrayOfProducts[index]);
        window.location = "product_page_test - Copy.html"; // redirects to details page
    }

    function assingAllEvent() {
        var btns = document.getElementsByClassName('detbtn');
        var titles = document.getElementsByClassName('title');
        var thumbs = document.getElementsByClassName('thumb');

        for(let i = 0; i < btns.length; i++) {
            btns[i].addEventListener('click',goToProductDetails);
            titles[i].addEventListener('click',goToProductDetails);
            thumbs[i].addEventListener('click',goToProductDetails);
        }
    }


</script>
<script src="main.js" async></script>
</body>
</html>